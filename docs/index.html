<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>rmapi-js</title><meta name="description" content="Documentation for rmapi-js"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">rmapi-js</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>rmapi-js </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#rmapi-js" id="rmapi-js" style="color: inherit; text-decoration: none;">
  <h1>rmapi-js</h1>
</a>
<p><a href="https://github.com/erikbrinkman/rmapi-js/actions/workflows/node.js.yml"><img src="https://github.com/erikbrinkman/rmapi-js/actions/workflows/node.js.yml/badge.svg" alt="build"></a>
<a href="https://erikbrinkman.github.io/rmapi-js/"><img src="https://img.shields.io/badge/docs-docs-blue" alt="docs"></a>
<a href="https://www.npmjs.com/package/rmapi-js"><img src="https://img.shields.io/npm/v/rmapi-js" alt="npm"></a>
<a href="LICENSE"><img src="https://img.shields.io/github/license/erikbrinkman/rmapi-js" alt="license"></a></p>
<p>JavaScript implementation of the reMarkable 1.5 api. This implementation is
built around web standards for fetch and crypto, but can easily be patched to
work for node. At the current time it&#39;s only partially complete, but has the
backbone to flush out more.</p>
<p>This implementation is based off of <a href="https://github.com/juruen/rmapi"><code>rmapi</code></a>,
but aims to be a little simpler. Currently this does no direct handling of the
document tree or syncing efficiently with the cloud, although that support can
be build on top of this library. To make those calls efficient, it will be
helpful to supply a custom cache.</p>

<a href="#api" id="api" style="color: inherit; text-decoration: none;">
  <h2>API</h2>
</a>
<p>Before using this API it&#39;s necessary to have some rudimentary understand of how
the API works.</p>
<p>All data is stored via its sha256 hash. This includes raw files and
&quot;collections&quot;, which have a special format listing all of their <code>Entry</code>s by
hash and id. Each document or folder is a collection of it&#39;s constituant files,
which inclue metadata about the object.  All documents and folders are in the
root collection, and there&#39;s a versioned hash which indicates the hash of the
root collection. The root hash version is it&#39;s &quot;generation&quot;.</p>

<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
  <h2>Usage</h2>
</a>
<p>To explore files in the cloud, you need to first register your api and persist
the token. Then you can use <code>getEntries</code> to explore entries of different file
collections.</p>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">register</span><span class="hl-1">, </span><span class="hl-2">remarkable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;rmapi-js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">code</span><span class="hl-1"> = </span><span class="hl-3">&quot;...&quot;</span><span class="hl-1">  </span><span class="hl-6">// eight letter code from https://my.remarkable.com/device/desktop/connect</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">token</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">register</span><span class="hl-1">(</span><span class="hl-2">code</span><span class="hl-1">)</span><br/><span class="hl-6">// persist token</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">api</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">remarkable</span><span class="hl-1">(</span><span class="hl-2">token</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">root</span><span class="hl-1">] = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">api</span><span class="hl-1">.</span><span class="hl-7">getRootHash</span><span class="hl-1">();</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">fileEntries</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">api</span><span class="hl-1">.</span><span class="hl-7">getEntries</span><span class="hl-1">(</span><span class="hl-2">root</span><span class="hl-1">);</span><br/><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">entry</span><span class="hl-1"> </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">fileEntries</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">children</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">api</span><span class="hl-1">.</span><span class="hl-7">getEntries</span><span class="hl-1">(</span><span class="hl-2">entry</span><span class="hl-1">.</span><span class="hl-2">hash</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">hash</span><span class="hl-1">, </span><span class="hl-5">documentId</span><span class="hl-1"> } </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">children</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">documentId</span><span class="hl-1">.</span><span class="hl-7">endsWith</span><span class="hl-1">(</span><span class="hl-3">&quot;.metadata&quot;</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">meta</span><span class="hl-1"> = </span><span class="hl-2">api</span><span class="hl-1">.</span><span class="hl-7">getMetadata</span><span class="hl-1">(</span><span class="hl-2">hash</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">// get metadata for entry</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-7">log</span><span class="hl-1">(</span><span class="hl-2">meta</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
<p>To upload an epub, simply call upload with the appropriate name and buffer.</p>
<pre><code class="language-ts"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">remarkable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;rmapi-js&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">api</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">remarkable</span><span class="hl-1">(...);</span><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">api</span><span class="hl-1">.</span><span class="hl-7">putEpub</span><span class="hl-1">(</span><span class="hl-3">&quot;document name&quot;</span><span class="hl-1">, </span><span class="hl-2">epubBuffer</span><span class="hl-1">);</span>
</code></pre>

<a href="#node" id="node" style="color: inherit; text-decoration: none;">
  <h3>Node</h3>
</a>
<p>This uses web standards by default, so using within node takes a little more effort.</p>
<p>You need import the node crypto library and assign it to globals</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">webcrypto</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;crypto&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">global</span><span class="hl-1">.</span><span class="hl-2">crypto</span><span class="hl-1"> = </span><span class="hl-2">webcrypto</span><span class="hl-1">;</span>
</code></pre>
<p>or optionally pass it into the constructor</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">webcrypto</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;crypto&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">api</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">remarkable</span><span class="hl-1">(</span><span class="hl-2">token</span><span class="hl-1">, { </span><span class="hl-2">digest:</span><span class="hl-1"> </span><span class="hl-2">webcrypto</span><span class="hl-1">.</span><span class="hl-2">subtle</span><span class="hl-1">.</span><span class="hl-2">digest</span><span class="hl-1"> });</span>
</code></pre>
<p>You also need to have a globally defined fetch. There are several ways to
accomplish this. In node 17.5 or higher you can enable global fetch with 
<code>node --experimental-fetch</code></p>
<p>You can also rely on <code>&quot;node-fetch&quot;</code> which is compliant enough</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fetch</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;node-fetch&quot;</span><span class="hl-1">;</span><br/><span class="hl-2">global</span><span class="hl-1">.</span><span class="hl-2">fetch</span><span class="hl-1"> = </span><span class="hl-2">fetch</span><span class="hl-1">;</span>
</code></pre>
<p>or</p>
<pre><code class="language-js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fetch</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;node-fetch&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">api</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-7">remarkable</span><span class="hl-1">(</span><span class="hl-2">token</span><span class="hl-1">, { </span><span class="hl-2">fetch</span><span class="hl-1"> });</span>
</code></pre>

<a href="#design" id="design" style="color: inherit; text-decoration: none;">
  <h2>Design</h2>
</a>
<p>Building a full syncing version of the remarkable filesystem from the cloud API
is a project in itselfs, so I opted to only implement the primative calls which
should still be possible to composte to advanced functionality.</p>
<p>In order to make this as easily cross platform as possible, web standards were
chosen as the basis since they enjoy relative adoption in node. However, node
has middling support of webstreams and since none of the reading or writing is
that intensive or doesn&#39;t already required the whole file in memory, we opted
to process strings or ArrayBuffers ignoring Readable and WriteableStreams for
the time being.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-class"><a href="classes/GenerationError.html" class="tsd-kind-icon">Generation<wbr/>Error</a></li><li class="tsd-kind-class"><a href="classes/ResponseError.html" class="tsd-kind-icon">Response<wbr/>Error</a></li><li class="tsd-kind-interface"><a href="interfaces/CacheLike.html" class="tsd-kind-icon">Cache<wbr/>Like</a></li><li class="tsd-kind-interface"><a href="interfaces/CollectionEntry.html" class="tsd-kind-icon">Collection<wbr/>Entry</a></li><li class="tsd-kind-interface"><a href="interfaces/CollectionTypeMetadata.html" class="tsd-kind-icon">Collection<wbr/>Type<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/CommonMetadata.html" class="tsd-kind-icon">Common<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/Content.html" class="tsd-kind-icon">Content</a></li><li class="tsd-kind-interface"><a href="interfaces/DocumentMetadata.html" class="tsd-kind-icon">Document<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/DocumentTypeMetadata.html" class="tsd-kind-icon">Document<wbr/>Type<wbr/>Metadata</a></li><li class="tsd-kind-interface"><a href="interfaces/FetchLike.html" class="tsd-kind-icon">Fetch<wbr/>Like</a></li><li class="tsd-kind-interface"><a href="interfaces/FileEntry.html" class="tsd-kind-icon">File<wbr/>Entry</a></li><li class="tsd-kind-interface"><a href="interfaces/HeadersLike.html" class="tsd-kind-icon">Headers<wbr/>Like</a></li><li class="tsd-kind-interface"><a href="interfaces/PutEpubOptions.html" class="tsd-kind-icon">Put<wbr/>Epub<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/RegisterOptions.html" class="tsd-kind-icon">Register<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/RemarkableApi.html" class="tsd-kind-icon">Remarkable<wbr/>Api</a></li><li class="tsd-kind-interface"><a href="interfaces/RemarkableOptions.html" class="tsd-kind-icon">Remarkable<wbr/>Options</a></li><li class="tsd-kind-interface"><a href="interfaces/RequestInitLike.html" class="tsd-kind-icon">Request<wbr/>Init<wbr/>Like</a></li><li class="tsd-kind-interface"><a href="interfaces/ResponseLike.html" class="tsd-kind-icon">Response<wbr/>Like</a></li><li class="tsd-kind-interface"><a href="interfaces/SubtleCryptoLike.html" class="tsd-kind-icon">Subtle<wbr/>Crypto<wbr/>Like</a></li><li class="tsd-kind-type-alias tsd-has-type-parameter"><a href="modules.html#Awaitable" class="tsd-kind-icon">Awaitable</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Entry" class="tsd-kind-icon">Entry</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ExtraMetadata" class="tsd-kind-icon">Extra<wbr/>Metadata</a></li><li class="tsd-kind-type-alias"><a href="modules.html#FileType" class="tsd-kind-icon">File<wbr/>Type</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Metadata" class="tsd-kind-icon">Metadata</a></li><li class="tsd-kind-type-alias"><a href="modules.html#RequestMethod" class="tsd-kind-icon">Request<wbr/>Method</a></li><li class="tsd-kind-type-alias"><a href="modules.html#TextAlignment" class="tsd-kind-icon">Text<wbr/>Alignment</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Transform" class="tsd-kind-icon">Transform</a></li><li class="tsd-kind-variable"><a href="modules.html#builtinFontNames" class="tsd-kind-icon">builtin<wbr/>Font<wbr/>Names</a></li><li class="tsd-kind-variable"><a href="modules.html#builtinLineHeights" class="tsd-kind-icon">builtin<wbr/>Line<wbr/>Heights</a></li><li class="tsd-kind-variable"><a href="modules.html#builtinMargins" class="tsd-kind-icon">builtin<wbr/>Margins</a></li><li class="tsd-kind-variable"><a href="modules.html#builtinTextScales" class="tsd-kind-icon">builtin<wbr/>Text<wbr/>Scales</a></li><li class="tsd-kind-variable"><a href="modules.html#builtinTools" class="tsd-kind-icon">builtin<wbr/>Tools</a></li><li class="tsd-kind-function"><a href="modules.html#register" class="tsd-kind-icon">register</a></li><li class="tsd-kind-function"><a href="modules.html#remarkable" class="tsd-kind-icon">remarkable</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>